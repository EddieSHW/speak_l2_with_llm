# Ollama 日本語音声チャットアプリケーション

ローカルで実行中の Ollama を使用して、Gemma3 などの LLM（大規模言語モデル）と日本語で会話できる Gradio アプリケーションです。音声入力と音声出力に対応しており、自然な会話体験を提供します。

## 機能

- 日本語での会話に最適化
- 音声入力：マイクからの日本語音声認識
- 音声出力：AI の応答を日本語音声に合成
- テキスト入力・出力も同時サポート
- Ollama にインストール済みのモデルを使用
- モデルのパラメータ調整（温度、最大トークン数）
- チャット履歴の保持
- 完全にローカルで動作（データは外部に送信されません）

## 前提条件

- Python 3.8 以上
- [Ollama](https://ollama.ai/)がインストール済みで実行中
- 少なくとも 1 つのモデルが Ollama にインストールされていること（推奨：gemma3）
- 音声認識には適切なマイク設定が必要

## インストール

1. リポジトリをクローン、またはファイルをダウンロードします。
2. 必要なパッケージをインストールします：

```bash
pip install -r requirements.txt
```

3. `.env.example`を`.env`にコピーし、必要に応じて設定を変更します：

```bash
cp .env.example .env
```

## 使い方

1. Ollama が実行中であることを確認します。
2. 以下のコマンドでアプリケーションを起動します：

```bash
python app.py
```

3. ブラウザで`http://localhost:7860`にアクセスしてアプリケーションを使用します。
4. テキスト入力または音声入力を使用して LLM と会話できます。
   - テキスト入力：入力ボックスにテキストを入力して Enter キーを押す
   - 音声入力：マイクボタンをクリックして話し、停止ボタンで音声認識を実行

## Ollama モデルのインストール方法

日本語での会話に適したモデルをインストールするには：

```bash
ollama pull gemma3
# または
ollama pull llama3
```

## トラブルシューティング

- **「Ollama サーバーに接続できません」エラー**：Ollama が実行中であることを確認してください。
- **音声認識エラー**：マイクが正しく設定されていることを確認してください。
- **音声出力が聞こえない**：ブラウザの音声設定を確認してください。
- **日本語の認識精度が低い**：静かな環境で、明瞭に話してください。
- **レスポンスが遅い**：より小さなモデルを使用するか、GPU アクセラレーションが有効になっていることを確認してください。

## 技術詳細

- **音声認識**: Google Speech Recognition API (SpeechRecognition)
- **音声合成**: Google Text-to-Speech (gTTS)
- **UI**: Gradio
- **LLM**: Ollama API (Gemma3 推奨)
